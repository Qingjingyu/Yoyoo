# Yoyoo 记忆双向增量同步（OpenClaw + Nanobot）

## 目标
- 本地 `Yoyoo/soul` 与服务器端 Yoyoo 记忆保持持续同步。
- 你离线在飞书与机器人沟通后，下次本地会自动拉回最新记忆。

## 脚本
- 增量同步主脚本：`Yoyoo/project/scripts/sync_yoyoo_memory_global.sh`
- macOS 定时服务脚本：`Yoyoo/project/scripts/yoyoo_memory_sync_service.sh`

## 同步策略
1. `pull`：先拉取服务器记忆（OpenClaw + Nanobot）到本地。
2. `push`：再将本地最新记忆推回服务器。
3. 冲突时不覆盖：保存到 `Yoyoo/soul/.sync_state/conflicts/`。
4. 远端快照归档：`Yoyoo/soul/remote_memory/`。

## 常用命令
```bash
# 手动单次同步（推荐日常排障时使用）
bash Yoyoo/project/scripts/sync_yoyoo_memory_global.sh sync

# 查看当前同步状态（本地/远端 hash）
bash Yoyoo/project/scripts/sync_yoyoo_memory_global.sh status

# 安装自动定时同步（每 180 秒一次）
YOYOO_SYNC_INTERVAL_SEC=180 bash Yoyoo/project/scripts/yoyoo_memory_sync_service.sh install

# 查看定时服务状态
bash Yoyoo/project/scripts/yoyoo_memory_sync_service.sh status

# 卸载定时服务
bash Yoyoo/project/scripts/yoyoo_memory_sync_service.sh uninstall
```

## 日志与状态
- 定时任务输出：`Yoyoo/soul/.sync_state/launchd.out.log`
- 定时任务错误：`Yoyoo/soul/.sync_state/launchd.err.log`
- 增量状态文件：`Yoyoo/soul/.sync_state/memory_sync_state.env`
